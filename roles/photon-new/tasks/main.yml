---
- name: Install base packages
  package:
    name:
      - python-docker
    state: present

- name: Create photon network
  docker_network:
    name: photon-network

- name: Install systemd files for nominatim-update
  template: src={{ item }} dest=/etc/systemd/system/
  with_items:
    - photon-new.service
    - photon-new-update.service
    - photon-new-update.timer
  notify:
    # photon.service dependens on nominatim.service so it's restarted, too.
    - Restart photon-new

- name: Start nomimatim and photon services
  systemd: state=started name="{{ item }}" enabled=yes daemon_reload=yes
  with_items:
    - photon-new.service
    - photon-new-update.timer
